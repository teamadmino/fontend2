!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("adm.@angular/common"),require("adm.@angular/cdk"),require("adm.@angular/material"),require("adm.rxjs"),require("adm.lodash"),require("adm.rxjs/operators"),require("adm.shared"),require("adm.@angular/core")):"function"==typeof define&&define.amd?define(["adm.@angular/common","adm.@angular/cdk","adm.@angular/material","adm.rxjs","adm.lodash","adm.rxjs/operators","adm.shared","adm.@angular/core"],e):"object"==typeof exports?exports.group=e(require("adm.@angular/common"),require("adm.@angular/cdk"),require("adm.@angular/material"),require("adm.rxjs"),require("adm.lodash"),require("adm.rxjs/operators"),require("adm.shared"),require("adm.@angular/core")):t.group=e(t["adm.@angular/common"],t["adm.@angular/cdk"],t["adm.@angular/material"],t["adm.rxjs"],t["adm.lodash"],t["adm.rxjs/operators"],t["adm.shared"],t["adm.@angular/core"])}("undefined"!=typeof self?self:this,function(t,e,n,o,i,r,a,s){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,(function(e){return t[e]}).bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/assets/plugins/group",n(n.s=0)}({0:function(t,e,n){t.exports=n("P+m1")},"0S4P":function(e,n){e.exports=t},"8Yb7":function(t,n){t.exports=e},MdUB:function(t,e){t.exports=n},"P+m1":function(t,e,n){"use strict";n.r(e),n.d(e,"GroupModule",function(){return B});var o=n("0S4P"),i=n("vOrQ"),r=n("cfyg"),a=n("YLtl"),s=n("8Yb7"),l=n("aP7H"),p=n("Vgaj"),c=function(){function t(t){this.el=t,this.activeState={},this.nextState={},this.positionConfigDefaults={construction:"default",minW:void 0,minH:void 0,maxW:void 0,maxH:void 0,initW:void 0,initH:void 0,fillX:void 0,fillY:void 0,x:-1,y:-1,h:-1,w:-1,index:-1,hidden:!1,append:!1,newline:!1,eol:!1,alignRight:!1,alignCenter:!1,alignBottom:!1,alignMiddle:!1,lineAlignBottom:!1,lineAlignMiddle:!1,stickyAuto:!1,stickyFloat:!1,stickyBehind:!1,selfSized:!1,parentSized:!1,clone:"",sticky:0,groupConfig:{innerPadding:0,elementsPadding:0,pageCenter:!1,pageMiddle:!1,justifiedGrid:!1},calculated:0,autoStickers:[],stickerHolder:void 0,sickerListeners:!1,layer:1,lastKnownSizeW:-1,lastKnownSizeH:-1},this.inited=!1,this.internalListeners={},this.eventListeners={},this.processedLayout={},this.prevProcessedLayout={},this.isDragging=!1,this.isMouseOver=!1,this.accessKeysChange$=new p.Subject,this.renderer=this.el.renderer}return t.prototype.listenEvent=function(t){var e=this;if(this.eventListeners[t])console.warn("Already listenting for event trigger",t,"on",this.getId());else{var n=this.renderer.listen(this.getWrapperDom(),t,function(n){e.layoutController.positionController.onElementEvent(e,t,n)});this.eventListeners[t]=n}},t.prototype.isListeningFor=function(t){return!!this.eventListeners[t]},t.prototype.init=function(t){var e=this;if(this.layoutController=t,this.layoutController.rootEl.el.wrapperComponentRef&&this.renderer.setStyle(this.getWrapperDom(),"position","absolute"),this.el.contentSizeChanged$.pipe(Object(l.takeUntil)(this.el.destroy$)).subscribe(function(t){e.layoutController.positionController.onElementSizeChanged(e,t)}),this.processLayoutConfig(),"group"===this.getType()){this.internalListeners.scroll=this.renderer.listen(this.el.pluginComponentRef.instance.wrapperEl.nativeElement,"scroll",function(t){e.layoutController.positionController.onGroupScroll(e)});var n=this.getChildren();n&&Object.keys(n).forEach(function(t){n[t].init(e.layoutController)})}this.inited=!0},t.prototype.update=function(t){if(this.inited||this.init(t),this.processLayoutConfig(),"group"===this.getType()){var e=this.getChildren();e&&Object.keys(e).forEach(function(n){e[n].update(t)})}},t.prototype.processLayoutBreakpoints=function(){var t=a.isNil(this.el.pluginConfig.layout)?{}:Object(a.cloneDeep)(this.el.pluginConfig.layout),e=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),n=this.el.pluginConfig.layoutBreakpoints;if(n){var o=[];Object.keys(n).forEach(function(t){var i=t.substr(0,1),r=parseInt(t.substring(1,t.length),10),a=n[t];"<"===i?e<r&&o.unshift({layout:a,breakpoint:r,dir:-1}):e>r&&o.push({layout:a,breakpoint:r,dir:1})}),o.sort(function(t,e){return t.dir>e.dir?-1:t.dir<e.dir?1:(t.breakpoint>e.breakpoint?1:-1)*t.dir}),o.forEach(function(e){Object.assign(t,e.layout)})}return t},t.prototype.processLayoutConfig=function(){var t,e,n=this;this.processedLayout=this.processLayoutBreakpoints();var o=this.processedLayout,i=Object(r.deepCompare)(this.prevProcessedLayout,this.processedLayout).diff;i.draggable&&(this.clearListener("mouseOver"),this.clearListener("mouseDown"),o.draggable&&(this.internalListeners.mouseOver=this.renderer.listen(this.getWrapperDom(),"mouseover",function(t){n.isMouseOver=!0,t.stopPropagation(),n.layoutController.activeEl===n||n.layoutController.activeElementEngaged||n.layoutController.dragDisabled||n.layoutController.activate(n)}),this.internalListeners.mouseLeave=this.renderer.listen(this.getWrapperDom(),"mouseleave",function(t){n.isMouseOver=!1,n.handleMouseLeave()}),this.internalListeners.mouseclickOutside=this.renderer.listen(document,"click",function(t){var e;n.isDragging||n.isMouseOver||n.control&&(null===(e=n.control)||void 0===e?void 0:e.isMouseOver)||n.layoutController.deactivate(n)})),o.draggable&&(this.internalListeners.mouseDown=this.renderer.listen(this.getPluginDom(),"mousedown",function(t){n.layoutController.activeEl===n&&n.layoutController.controls.instance.dragStart(t)}))),i.dropzone&&(this.accessKeysChange$.next(),(null===(t=null==o?void 0:o.dropzone)||void 0===t?void 0:t.acceptKeys)&&(null===(e=null==o?void 0:o.dropzone)||void 0===e?void 0:e.showIndicator)?(this.renderer.addClass(this.getWrapperDom(),"adm-drop-zone"),this.layoutController.positionController.dragStart$.pipe(Object(l.takeUntil)(this.el.destroy$),Object(l.takeUntil)(this.accessKeysChange$)).subscribe(function(t){n.layoutController.positionController.canBeDropped(t.el,n)&&n.renderer.addClass(n.getWrapperDom(),"adm-drop-zone-active")}),this.layoutController.positionController.dragEnd$.pipe(Object(l.takeUntil)(this.el.destroy$),Object(l.takeUntil)(this.accessKeysChange$)).subscribe(function(t){n.renderer.removeClass(n.getWrapperDom(),"adm-drop-zone-active")})):this.renderer.removeClass(this.getWrapperDom(),"adm-drop-zone")),this.prevProcessedLayout=Object(a.cloneDeep)(this.processedLayout)},t.prototype.handleMouseLeave=function(){var t=this;clearTimeout(this.mouseLeaveTimeoutHelper),this.mouseLeaveTimeoutHelper=setTimeout(function(){var e;t.isDragging||t.isMouseOver||t.control&&(null===(e=t.control)||void 0===e?void 0:e.isMouseOver)||t.layoutController.activeElementEngaged||t.layoutController.deactivate(t)})},t.prototype.clearListener=function(t){this.internalListeners[t]&&(this.internalListeners[t](),delete this.internalListeners[t])},t.prototype.getParent=function(){var t,e,n,o;return null===(o=null===(n=null===(e=null===(t=this.el)||void 0===t?void 0:t.parentContext)||void 0===e?void 0:e.pluginComponentRef)||void 0===n?void 0:n.instance)||void 0===o?void 0:o.layoutElement},t.prototype.getRoot=function(){var t,e;return null===(e=null===(t=this.getParentContext())||void 0===t?void 0:t.rootContext.pluginComponentRef.instance)||void 0===e?void 0:e.layoutElement},t.prototype.getLayoutController=function(){var t,e;return null===(e=null===(t=this.getParentContext())||void 0===t?void 0:t.rootContext.pluginComponentRef.instance)||void 0===e?void 0:e.layoutController},t.prototype.applyMinMaxToNextStateNaturalSize=function(){this.nextState.naturalWidth<this.positionConfig.minW&&(this.nextState.naturalWidth=this.positionConfig.minW),this.nextState.naturalWidth>this.positionConfig.maxW&&-1!==this.positionConfig.maxW&&(this.nextState.naturalWidth=this.positionConfig.maxW),this.nextState.naturalHeight<this.positionConfig.minH&&(this.nextState.naturalHeight=this.positionConfig.minH),this.nextState.naturalHeight>this.positionConfig.maxH&&-1!==this.positionConfig.maxH&&(this.nextState.naturalHeight=this.positionConfig.maxH)},t.prototype.getScript=function(){var t;return a.isNil(this.processedLayout)||a.isNil(null===(t=this.processedLayout)||void 0===t?void 0:t.script)?[]:this.processedLayout.script.split(",")},t.prototype.getIntInRangeOrDefault=function(t,e,n,o){return void 0===t||(t=Math.round(t))<e||n<t?o:t},t.prototype.getNumberInRangeOrDefault=function(t,e,n,o){return void 0===t||t<e||n<t?o:t},t.prototype.getBooleanOrDefault=function(t,e){return void 0===t?e:t},t.prototype.setupConfig=function(){var t,e,n=this;this.positionConfig=Object(a.cloneDeep)(this.positionConfigDefaults),this.processLayoutConfig();var o=this.processedLayout;if(!a.isNil(o.clone)||!a.isNil(this.getParent())){var i=this.getParent().getChildren()[o.clone];if(!Object(a.isNil)(i)&&!a.isNil(i.getLayout())){this.positionConfig.clone=o.clone;var r=Object(a.cloneDeep)(i.getLayout());Object.assign(r,o),o=r}}void 0!==o.construction&&(this.positionConfig.construction=o.construction);var s=this.getIntInRangeOrDefault(o.h,1,99999,-1);s>0?this.positionConfig.minH=this.positionConfig.maxH=s:(this.positionConfig.minH=this.getIntInRangeOrDefault(o.minH,1,99999,-1),this.positionConfig.maxH=this.getIntInRangeOrDefault(o.maxH,1,99999,-1));var l=this.getIntInRangeOrDefault(o.w,1,99999,-1);if(l>0?this.positionConfig.minW=this.positionConfig.maxW=l:(this.positionConfig.minW=this.getIntInRangeOrDefault(o.minW,1,99999,-1),this.positionConfig.maxW=this.getIntInRangeOrDefault(o.maxW,1,99999,-1)),this.positionConfig.fillX=this.getNumberInRangeOrDefault(o.fillX,0,99999,0),this.positionConfig.fillY=this.getNumberInRangeOrDefault(o.fillY,0,99999,0),this.positionConfig.initW=this.getNumberInRangeOrDefault(o.initW,0,99999,-1),this.positionConfig.initH=this.getNumberInRangeOrDefault(o.initH,0,99999,-1),this.positionConfig.x=this.getNumberInRangeOrDefault(o.x,0,99999,-1),this.positionConfig.y=this.getNumberInRangeOrDefault(o.y,0,99999,-1),this.positionConfig.h=this.getNumberInRangeOrDefault(o.h,0,99999,-1),this.positionConfig.w=this.getNumberInRangeOrDefault(o.w,0,99999,-1),this.positionConfig.index=this.getNumberInRangeOrDefault(o.index,0,99999,-1),this.positionConfig.hidden=this.getBooleanOrDefault(o.hidden,!1),this.positionConfig.append=!1,this.positionConfig.newline=!1,this.positionConfig.eol=!1,this.positionConfig.alignRight=!1,this.positionConfig.alignCenter=!1,this.positionConfig.alignBottom=!1,this.positionConfig.alignMiddle=!1,this.positionConfig.lineAlignBottom=!1,this.positionConfig.lineAlignMiddle=!1,this.positionConfig.stickyAuto=!1,this.positionConfig.stickyFloat=!1,this.getScript().forEach(function(t){switch(t){case"append":n.positionConfig.append=!0;break;case"newline":n.positionConfig.newline=!0;break;case"eol":n.positionConfig.eol=!0;break;case"alignRight":n.positionConfig.alignRight=!0;break;case"alignCenter":n.positionConfig.alignCenter=!0;break;case"alignBottom":n.positionConfig.alignBottom=!0;break;case"alignMiddle":n.positionConfig.alignMiddle=!0;break;case"lineAlignBottom":n.positionConfig.lineAlignBottom=!0;break;case"lineAlignMiddle":n.positionConfig.lineAlignMiddle=!0;break;case"sticky-tl":n.positionConfig.sticky=36;break;case"sticky-tc":n.positionConfig.sticky=34;break;case"sticky":case"sticky-tr":n.positionConfig.sticky=33;break;case"sticky-ml":n.positionConfig.sticky=20;break;case"sticky-mc":n.positionConfig.sticky=18;break;case"sticky-mr":n.positionConfig.sticky=17;break;case"sticky-bl":n.positionConfig.sticky=12;break;case"sticky-bc":n.positionConfig.sticky=10;break;case"sticky-br":n.positionConfig.sticky=9;break;case"stickyAuto":n.positionConfig.stickyAuto=!0,0==n.positionConfig.sticky&&(n.positionConfig.sticky=33);break;case"stickyFloat":n.positionConfig.stickyFloat=!0,0==n.positionConfig.sticky&&(n.positionConfig.sticky=33);break;case"stickyBehind":n.positionConfig.stickyBehind=!0,0==n.positionConfig.sticky&&(n.positionConfig.sticky=33);break;case"selfSized":n.positionConfig.selfSized=!0;break;case"parentSized":n.positionConfig.parentSized=!0;break;case"":break;default:console.error("Unknown script command: ",n.getId(),"=>",t)}}),this.positionConfig.layer=this.getNumberInRangeOrDefault(o.layer,1,99999,1),"group"===this.getType()){var p=a.isNil(null===(t=this.el.pluginConfig.config)||void 0===t?void 0:t.layoutConfig)?{}:null===(e=this.el.pluginConfig.config)||void 0===e?void 0:e.layoutConfig;this.positionConfig.groupConfig.innerPadding=this.getIntInRangeOrDefault(p.innerPadding,-99999,99999,0),this.positionConfig.groupConfig.elementsPadding=this.getIntInRangeOrDefault(p.elementsPadding,0,99999,0),this.positionConfig.groupConfig.pageCenter=this.getBooleanOrDefault(p.pageCenter,!1),this.positionConfig.groupConfig.pageMiddle=this.getBooleanOrDefault(p.pageMiddle,!1),this.positionConfig.groupConfig.justifiedGrid=this.getBooleanOrDefault(p.justifiedGrid,!1)}},t.prototype.getParentDom=function(){return this.el.currentParentContext.pluginComponentRef.instance.wrapperEl.nativeElement},t.prototype.getParentVC=function(){return this.el.currentParentContext.pluginComponentRef.instance.targetVC},t.prototype.getParentContext=function(){return this.el.parentContext},t.prototype.getWrapperDom=function(){var t,e;return null===(e=null===(t=this.el)||void 0===t?void 0:t.wrapperComponentRef)||void 0===e?void 0:e.location.nativeElement},t.prototype.getPluginDom=function(){return this.el.pluginComponentRef.location.nativeElement},t.prototype.getPlugin=function(){return this.el.pluginComponentRef},t.prototype.getTargetVC=function(){return"group"!==this.getType()?(console.warn("Only groups have target ViewContainer"),null):this.el.pluginComponentRef.instance.targetVC},t.prototype.getType=function(){return this.el.pluginConfig.type},t.prototype.getId=function(){return this.el.id},t.prototype.getChildren=function(){return"group"===this.getType()?this.el.pluginComponentRef.instance.layoutElements:null},t.prototype.getWrapper=function(){return this.el.wrapperComponentRef.instance},t.prototype.getLayout=function(){return this.el.pluginConfig.layout},t.prototype.getLayoutConfig=function(){var t;return null===(t=this.el.parentContext.pluginConfig.config)||void 0===t?void 0:t.layoutConfig},t.prototype.getConfig=function(){return this.el.pluginConfig},t.prototype.getScrolledDom=function(){return"group"===this.getType()?this.el.pluginComponentRef.instance.wrapperEl.nativeElement:null},t.prototype.getLocalMousePosition=function(){var t=this.layoutController.mousePos,e=this.getWrapperDom().getBoundingClientRect();return{x:t.x-e.left,y:t.y-e.top}},t.prototype.getRootVC=function(){return this.el.rootContext.pluginComponentRef.instance.targetVC},t.prototype.redraw=function(){return this.el.redraw$.next()},t.prototype.calculateNaturalSize=function(){var t=0,e=0;if(this.getScrolledDom()&&(t=this.getScrolledDom().scrollTop,e=this.getScrolledDom().scrollLeft),void 0!==this.el.wrapperComponentRef){if(1==this.positionConfig.calculated||2==this.positionConfig.calculated)return{width:this.nextState.naturalWidth,height:this.nextState.naturalHeight,clientWidth:this.nextState.naturalWidth,clientHeight:this.nextState.naturalHeight};if(this.positionConfig.h>0&&this.positionConfig.w>0)return{width:this.positionConfig.w,height:this.positionConfig.h,clientWidth:this.positionConfig.w,clientHeight:this.positionConfig.h};var n,o,i,r,s,l,p=this.getWrapperDom().style.position;this.renderer.setStyle(this.getWrapperDom(),"position","absolute"),Object(a.isNil)(this.getWrapperDom().parentNode)||(n=this.getWrapperDom().parentNode.style.minWidth,o=this.getWrapperDom().parentNode.style.minHeight,s=this.getWrapperDom().parentNode.style.maxWidth,l=this.getWrapperDom().parentNode.style.maxHeight,i=this.getWrapperDom().parentNode.style.minWidth,r=this.getWrapperDom().parentNode.style.minHeight,this.renderer.setStyle(this.getWrapperDom().parentNode,"min-width","99999px"),this.renderer.setStyle(this.getWrapperDom().parentNode,"min-height","99999px"),this.renderer.setStyle(this.getWrapperDom().parentNode,"max-width","99999px"),this.renderer.setStyle(this.getWrapperDom().parentNode,"max-height","99999px"),this.renderer.setStyle(this.getWrapperDom().parentNode,"width","99999px"),this.renderer.setStyle(this.getWrapperDom().parentNode,"height","99999px")),this.renderer.removeStyle(this.getWrapperDom(),"width"),this.renderer.removeStyle(this.getWrapperDom(),"height"),this.renderer.removeStyle(this.getWrapperDom(),"max-width"),this.renderer.removeStyle(this.getWrapperDom(),"max-height");var c=this.getWrapperDom().style.top,u=this.getWrapperDom().style.left,h=this.getWrapperDom().style.transition;this.renderer.setStyle(this.getWrapperDom(),"transition","none"),3!=this.positionConfig.calculated&&(this.renderer.setStyle(this.getWrapperDom(),"top",0),this.renderer.setStyle(this.getWrapperDom(),"left",0));var d=this.el.pluginComponentRef.location.nativeElement,g=d.style.maxWidth,f=d.style.maxHeight,m=d.style.minWidth,v=d.style.minHeight;this.positionConfig.maxW>0&&this.renderer.setStyle(d,"max-width",this.positionConfig.maxW+"px"),this.positionConfig.minW>0&&this.renderer.setStyle(d,"min-width",this.positionConfig.minW+"px"),this.positionConfig.maxH>0&&this.renderer.setStyle(d,"max-height",this.positionConfig.maxH+"px"),this.positionConfig.minH>0&&this.renderer.setStyle(d,"min-height",this.positionConfig.minH+"px");var y=d;"group"===this.getType()&&(y=this.el.pluginComponentRef.instance.wrapperEl.nativeElement);var C=y.getBoundingClientRect(),x=this.positionConfig.parentSized?{width:0,height:0,clientWidth:0,clientHeight:0}:{width:C.width,height:C.height,clientWidth:y.clientWidth,clientHeight:y.clientHeight};return-1!=this.positionConfig.initW&&(x.width=this.positionConfig.initW),-1!=this.positionConfig.initH&&(x.height=this.positionConfig.initH),this.positionConfig.maxH>0&&x.height>this.positionConfig.maxH&&(x.height=this.positionConfig.maxH),this.positionConfig.minH>0&&x.height<this.positionConfig.minH&&(x.height=this.positionConfig.minH),this.positionConfig.maxW>0&&x.width>this.positionConfig.maxW&&(x.width=this.positionConfig.maxW),this.positionConfig.minW>0&&x.width<this.positionConfig.minW&&(x.width=this.positionConfig.minW),this.positionConfig.maxW>0&&this.renderer.setStyle(d,"max-width",g),this.positionConfig.minW>0&&this.renderer.setStyle(d,"min-width",m),this.positionConfig.maxH>0&&this.renderer.setStyle(d,"max-height",f),this.positionConfig.minH>0&&this.renderer.setStyle(d,"min-height",v),Object(a.isNil)(this.getWrapperDom().parentNode)||(this.renderer.setStyle(this.getWrapperDom().parentNode,"min-width",i),this.renderer.setStyle(this.getWrapperDom().parentNode,"min-height",r),this.renderer.setStyle(this.getWrapperDom().parentNode,"max-width",s),this.renderer.setStyle(this.getWrapperDom().parentNode,"max-height",l),this.renderer.setStyle(this.getWrapperDom().parentNode,"width",n),this.renderer.setStyle(this.getWrapperDom().parentNode,"height",o)),this.renderer.setStyle(this.getWrapperDom(),"top",c),this.renderer.setStyle(this.getWrapperDom(),"left",u),this.renderer.setStyle(this.getWrapperDom(),"transition",h),this.renderer.setStyle(this.el.wrapperComponentRef.location.nativeElement,"position",p),this.positionConfig.calculated=1,this.getScrolledDom()&&(this.getScrolledDom().scrollTop=t,this.getScrolledDom().scrollLeft=e),x}},t.prototype.setNextState=function(t){Object.assign(this.nextState,t)},t.prototype.updateState=function(){this.applyState(this.nextState)},t.prototype.resetState=function(){this.nextState=Object(a.cloneDeep)(this.activeState),this.applyState(this.nextState)},t.prototype.commitState=function(){var t=this.nextState;this.activeState=Object.assign(this.activeState,this.nextState),this.applyState(t)},t.prototype.applyState=function(t){var e=this.getWrapperDom();this.renderer.setStyle(e,"left",t.left+"px"),this.renderer.setStyle(e,"top",t.top+"px"),this.renderer.setStyle(e,"width",t.width+"px"),this.renderer.setStyle(e,"height",t.height+"px"),this.renderer.setStyle(e,"max-width",t.width+"px"),this.renderer.setStyle(e,"max-height",t.height+"px"),this.renderer.setStyle(e,"z-index",t.zIndex),this.renderer.setStyle(e,"opacity",t.opacity),this.renderer.setStyle(e,"transition",t.transition),this.renderer.setStyle(e,"padding",(Object(a.isNil)(t.paddingTop)?0:t.paddingTop)+"px\n      "+(Object(a.isNil)(t.paddingRight)?0:t.paddingRight)+"px\n      "+(Object(a.isNil)(t.paddingBottom)?0:t.paddingBottom)+"px\n      "+(Object(a.isNil)(t.paddingLeft)?0:t.paddingLeft)+"px")},t.prototype.applyStyles=function(t){var e=this,n=this.getWrapperDom();Object.keys(t).forEach(function(o){e.renderer.setStyle(n,o,t[o])})},t.prototype.destroy=function(){var t,e=this;clearTimeout(this.mouseLeaveTimeoutHelper),null===(t=this.layoutController)||void 0===t||t.positionController.onElementDestroy(this),Object.keys(this.internalListeners).forEach(function(t){e.internalListeners[t]()}),Object.keys(this.eventListeners).forEach(function(t){e.eventListeners[t]()}),this.el.destroy()},t}(),u=["buttonsRef"],h=function(t,e){return{top:t,right:e}};function d(t,e){if(1&t){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"app-layout-element-button-controls",4,5),i["\u0275\u0275listener"]("buttonEvent",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().handleButtonEvent(t)}),i["\u0275\u0275elementEnd"]()}if(2&t){var o=i["\u0275\u0275nextContext"]();i["\u0275\u0275property"]("editButtons",o.editButtons)("ngClass",i["\u0275\u0275pureFunction2"](3,h,o.buttons&&o.top+o.elRef.nativeElement.offsetHeight+o.buttons.nativeElement.offsetHeight>o.elRef.nativeElement.parentElement.clientHeight+o.elRef.nativeElement.parentElement.scrollTop,o.buttons&&o.left-(o.buttons.nativeElement.offsetWidth-o.elRef.nativeElement.offsetWidth)<0))("dragActive",o.dragActive)}}var g=function(t){return{"drag-active":t}};function f(t,e){if(1&t){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementContainerStart"](0),i["\u0275\u0275elementStart"](1,"div",6),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"n")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](2,"div",7),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"s")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](3,"div",8),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"w")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](4,"div",9),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"e")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](5,"div",10),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"nw")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](6,"div",11),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"ne")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](7,"div",12),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"sw")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](8,"div",13),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"se")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](9,"div",14),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"n")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](10,"div",15),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"s")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](11,"div",16),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"w")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](12,"div",17),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().scaleStart(t,"e")}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementStart"](13,"div",18),i["\u0275\u0275listener"]("mousedown",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().dragStart(t)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementContainerEnd"]()}if(2&t){var o=i["\u0275\u0275nextContext"]();i["\u0275\u0275advance"](13),i["\u0275\u0275property"]("ngClass",i["\u0275\u0275pureFunction1"](1,g,o.dragActive))}}var m=function(){function t(t,e,n){this.renderer=t,this.cd=e,this.elRef=n,this.ids=[],this.dragStart$=new p.Subject,this.drag$=new p.Subject,this.dragEnd$=new p.Subject,this.scale$=new p.Subject,this.scaleEnd$=new p.Subject,this.scaleStart$=new p.Subject,this.mouseEnter$=new p.Subject,this.mouseLeave$=new p.Subject,this.click$=new p.Subject,this.buttonEvent$=new p.Subject,this.doubleClick$=new p.Subject,this.bgStyle={},this.dragActive=!1,this.scaleActive=!1,this.dragData={startX:0,startY:0,deltaX:0,deltaY:0},this.isMouseOver=!1,this.renderer.setStyle(this.elRef.nativeElement,"z-index",1e5)}return t.prototype.evt=function(t){this.click$.next({ids:this.ids,data:null,e:t})},t.prototype.mouseUp=function(t){clearTimeout(this.dragTimer)},t.prototype.mouseEnter=function(t){this.isMouseOver=!0,this.mouseEnter$.next({ids:this.ids,data:t,e:t})},t.prototype.mouseLeave=function(t){this.isMouseOver=!1,this.mouseLeave$.next({ids:this.ids,data:t,e:t})},t.prototype.handleButtonEvent=function(t){t.editButton.supportDrag?(this.editButton=t.editButton,this.dragStart(t.event,this.editButton)):this.buttonEvent$.next({ids:this.ids,data:null,editButton:t.editButton,e:t.event})},t.prototype.ngOnInit=function(){},t.prototype.ngAfterViewInit=function(){this.cd.detectChanges()},t.prototype.applyBgStyle=function(t){Object.assign(this.bgStyle,t),this.cd.markForCheck()},t.prototype.doubleClick=function(t){this.doubleClick$.next({ids:this.ids,data:null,e:t})},t.prototype.setIds=function(t){this.ids=t},t.prototype.dragStart=function(t,e){var n=this;void 0===e&&(e=null),clearTimeout(this.dragTimer),t.preventDefault();var o=this.wrapperEl.nativeElement.getBoundingClientRect();this.dragData.startX=t.clientX-o.left,this.dragData.startY=t.clientY-o.top,this.dragTimer=setTimeout(function(o){n.dragActive=!0,delete n.dragData.direction,n.registerMouseListeners(),n.dragStart$.next({ids:n.ids,data:n.dragData,editButton:e,e:t})},100)},t.prototype.scaleStart=function(t,e){t.preventDefault();var n=this.wrapperEl.nativeElement.getBoundingClientRect();this.dragData.startX=t.clientX-n.left,this.dragData.startY=t.clientY-n.top,this.dragData.direction=e,this.scaleActive=!0,this.registerMouseListeners(),this.scaleStart$.next({ids:this.ids,data:this.dragData,e:t})},t.prototype.onMouseMove=function(t){var e=this.wrapperEl.nativeElement.getBoundingClientRect();this.dragData.deltaX=t.clientX-e.left-this.dragData.startX,this.dragData.deltaY=t.clientY-e.top-this.dragData.startY,this.dragActive&&this.drag$.next({ids:this.ids,data:this.dragData,editButton:this.editButton,e:t}),this.scaleActive&&this.scale$.next({ids:this.ids,data:this.dragData,e:t})},t.prototype.onMouseUp=function(t){this.dragActive&&this.dragEnd$.next({ids:this.ids,data:this.dragData,editButton:this.editButton,e:t}),this.scaleActive&&this.scaleEnd$.next({ids:this.ids,data:this.dragData,e:t}),this.editButton=null,this.dragActive=!1,this.scaleActive=!1,this.cleanUpMouseListeners(),this.cd.markForCheck()},t.prototype.registerMouseListeners=function(){var t=this;this.cleanUpMouseListeners(),this.mouseUpListener=this.renderer.listen("window","mouseup",function(e){return t.onMouseUp(e)}),this.mouseMoveListener=this.renderer.listen("window","mousemove",function(e){return t.onMouseMove(e)})},t.prototype.cleanUpMouseListeners=function(){this.mouseUpListener&&this.mouseUpListener(),this.mouseMoveListener&&this.mouseMoveListener()},t.prototype.ngOnDestroy=function(){this.scaleActive&&this.scaleEnd$.next({ids:this.ids,data:this.dragData,e:null}),this.dragActive&&this.dragEnd$.next({ids:this.ids,data:this.dragData,editButton:this.editButton,e:null}),this.cleanUpMouseListeners()},t.prototype.setPos=function(t){this.top=t.top,this.left=t.left;var e=this.elRef.nativeElement;this.renderer.setStyle(e,"left",t.left+"px"),this.renderer.setStyle(e,"top",t.top+"px")},t.prototype.setSize=function(t){var e=this.elRef.nativeElement;this.renderer.setStyle(e,"width",t.width+"px"),this.renderer.setStyle(e,"height",t.height+"px"),this.renderer.setStyle(e,"max-width",t.width+"px"),this.renderer.setStyle(e,"max-height",t.height+"px")},t.prototype.setTransition=function(t){this.renderer.setStyle(this.elRef.nativeElement,"transition",t)},t.prototype.hide=function(){this.renderer.setStyle(this.elRef.nativeElement,"display","none")},t.prototype.show=function(){this.renderer.setStyle(this.elRef.nativeElement,"display","block")},t.prototype.update=function(){this.layoutController.updateControl()},t.\u0275fac=function(e){return new(e||t)(i["\u0275\u0275directiveInject"](i.Renderer2),i["\u0275\u0275directiveInject"](i.ChangeDetectorRef),i["\u0275\u0275directiveInject"](i.ElementRef))},t.\u0275cmp=i["\u0275\u0275defineComponent"]({type:t,selectors:[["app-layout-element-controls"]],viewQuery:function(t,e){var n;1&t&&i["\u0275\u0275viewQuery"](u,!0,i.ElementRef),2&t&&i["\u0275\u0275queryRefresh"](n=i["\u0275\u0275loadQuery"]())&&(e.buttons=n.first)},hostBindings:function(t,e){1&t&&i["\u0275\u0275listener"]("click",function(t){return e.evt(t)})("mouseup",function(t){return e.mouseUp(t)},!1,i["\u0275\u0275resolveDocument"])("mouseenter",function(t){return e.mouseEnter(t)})("mouseleave",function(t){return e.mouseLeave(t)})},decls:4,vars:6,consts:[["class","control-buttons",3,"editButtons","ngClass","dragActive","buttonEvent",4,"ngIf"],[1,"wrapper",3,"dblclick"],[1,"bg",3,"ngClass","ngStyle","mousedown"],[4,"ngIf"],[1,"control-buttons",3,"editButtons","ngClass","dragActive","buttonEvent"],["buttonsRef",""],[1,"drag","horizontal","top",3,"mousedown"],[1,"drag","horizontal","bottom",3,"mousedown"],[1,"drag","vertical","left",3,"mousedown"],[1,"drag","vertical","right",3,"mousedown"],[1,"drag","corner","nw",3,"mousedown"],[1,"drag","corner","ne",3,"mousedown"],[1,"drag","corner","sw",3,"mousedown"],[1,"drag","corner","se",3,"mousedown"],[1,"drag","center-control","n",3,"mousedown"],[1,"drag","center-control","s",3,"mousedown"],[1,"drag","center-control","w",3,"mousedown"],[1,"drag","center-control","e",3,"mousedown"],[1,"drag","center-drag",3,"ngClass","mousedown"]],template:function(t,e){1&t&&(i["\u0275\u0275template"](0,d,2,6,"app-layout-element-button-controls",0),i["\u0275\u0275elementStart"](1,"div",1),i["\u0275\u0275listener"]("dblclick",function(t){return e.doubleClick(t)}),i["\u0275\u0275elementStart"](2,"div",2),i["\u0275\u0275listener"]("mousedown",function(t){return e.dragStart(t)}),i["\u0275\u0275elementEnd"](),i["\u0275\u0275template"](3,f,14,3,"ng-container",3),i["\u0275\u0275elementEnd"]()),2&t&&(i["\u0275\u0275property"]("ngIf",e.editButtons),i["\u0275\u0275advance"](2),i["\u0275\u0275property"]("ngClass",i["\u0275\u0275pureFunction1"](4,g,e.dragActive))("ngStyle",e.bgStyle),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",null==e.draggable?null:e.draggable.scalable))},styles:['[_nghost-%COMP%]{outline:3px solid rgba(var(--theme-accent-500),.9);outline-offset:-3px;width:100%;height:100%;top:0;left:0;position:absolute;pointer-events:none;cursor:"grabbing"}.cantDrop[_nghost-%COMP%]{outline:3px solid rgba(var(--theme-warn-500),.5)}.cantDrop[_nghost-%COMP%], .cantDrop[_nghost-%COMP%]   .bg[_ngcontent-%COMP%]{cursor:"no-drop"!important}[_nghost-%COMP%]   .control-buttons[_ngcontent-%COMP%]{position:absolute;bottom:100%;right:0;top:100%;bottom:auto;pointer-events:all}[_nghost-%COMP%]   .control-buttons.top[_ngcontent-%COMP%]{bottom:100%;top:auto}[_nghost-%COMP%]   .control-buttons.right[_ngcontent-%COMP%]{left:0;right:auto}.wrapper[_ngcontent-%COMP%]{top:0;left:0;opacity:1;transition:opacity .2s;pointer-events:none}.bg[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute}.bg[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.bg.drag-active[_ngcontent-%COMP%]{pointer-events:all}.info[_ngcontent-%COMP%]{top:15px;left:15px;word-wrap:break-word;max-width:100%;padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none;pointer-events:none;font-size:10px;background-color:rgba(50,50,50,.5)}.corner[_ngcontent-%COMP%], .info[_ngcontent-%COMP%]{position:absolute}.corner[_ngcontent-%COMP%]{pointer-events:all;width:10px;height:10px;background-color:rgba(var(--theme-background-600));border:2px solid rgba(var(--theme-accent-600));border-radius:5px}.corner.nw[_ngcontent-%COMP%]{top:-5px;left:-5px;cursor:nw-resize}.corner.ne[_ngcontent-%COMP%]{top:-5px;right:-5px;cursor:ne-resize}.corner.sw[_ngcontent-%COMP%]{bottom:-5px;left:-5px;cursor:sw-resize}.corner.se[_ngcontent-%COMP%]{bottom:-5px;right:-5px;cursor:se-resize}.center-drag[_ngcontent-%COMP%]{width:10px;height:10px;position:absolute;background-color:rgba(var(--theme-accent-600));border-radius:5px;top:50%;left:50%;transform:translateX(-50%) translateY(-50%);pointer-events:all;cursor:-webkit-grab;cursor:grab}.center-drag.drag-active[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.center-control[_ngcontent-%COMP%]{pointer-events:all;width:7px;height:7px;position:absolute;background-color:rgba(var(--theme-accent-600));border-radius:5px}.center-control.n[_ngcontent-%COMP%]{top:-3.5px;left:calc(50% - 3.5px);cursor:n-resize}.center-control.s[_ngcontent-%COMP%]{bottom:-3.5px;left:calc(50% - 3.5px);cursor:s-resize}.center-control.w[_ngcontent-%COMP%]{left:-3.5px;cursor:w-resize}.center-control.e[_ngcontent-%COMP%], .center-control.w[_ngcontent-%COMP%]{top:calc(50% - 3.5px);transform:rotate(90deg)}.center-control.e[_ngcontent-%COMP%]{right:-3.5px;cursor:e-resize}.horizontal[_ngcontent-%COMP%]{pointer-events:all;cursor:n-resize;position:absolute;width:100%;height:10px;left:0}.horizontal.top[_ngcontent-%COMP%]{top:0}.horizontal.bottom[_ngcontent-%COMP%]{cursor:s-resize;bottom:0}.vertical[_ngcontent-%COMP%]{pointer-events:all;cursor:w-resize;position:absolute;height:100%;width:10px;top:0}.vertical.left[_ngcontent-%COMP%]{left:0}.vertical.right[_ngcontent-%COMP%]{cursor:e-resize;right:0}.topleft[_ngcontent-%COMP%]{cursor:nw-resize;left:0;top:0}.topright[_ngcontent-%COMP%]{cursor:ne-resize;right:0;top:0}.bottomleft[_ngcontent-%COMP%]{cursor:sw-resize;left:0;bottom:0}.bottomright[_ngcontent-%COMP%]{cursor:se-resize;right:0;bottom:0}']}),t}(),v=function(){function t(t,e){this.rootEl=t,this.layoutController=e,this.tempElements={},this.timeouts=[],this.activeElements=[],this.maintenanceActivated=!1,this.maintenanceFrequency=1e3,this.maintenanceRootSizeMismatch=0,this.maintenanceCounter=0,this.destroy$=new p.Subject,this.elementSizeChanged$=new p.Subject,this.dragStart$=new p.Subject,this.dragEnd$=new p.Subject,this.dragTempData={},this.isDragging=!1,this.transition="left 0.3s, top 0.3s, width 0.3s, height 0.3s, max-width 0.3s, min-width 0.3s, max-height 0.3s, min-height 0.3s, outline 0.3s",this.transitionNone="outline 0.3s"}return t.prototype.init=function(){var t=this;this.initEl(this.rootEl,!1,!0),this.elementSizeChanged$.pipe(Object(l.takeUntil)(this.destroy$)).subscribe(function(){}),this.elementSizeChanged$.pipe(Object(l.takeUntil)(this.destroy$),Object(r.bufferedDebounceTime)(300)).subscribe(function(e){e.forEach(function(t){t.el.positionConfig.calculated=3}),t.initEl(t.rootEl,!1)}),this.unlistenLoadingDone=this.layoutController.renderer.listen(document.fonts,"loadingdone",function(){t.initEl(t.rootEl,!0,!0)})},t.prototype.disableTransitions=function(t){var e=this;t.getWrapperDom()&&this.layoutController.renderer.setStyle(t.getWrapperDom(),"transition",this.transitionNone);var n=t.getChildren();n&&Object.values(n).forEach(function(t){return e.disableTransitions(t)})},t.prototype.enableTransitions=function(t){var e=this;t.getWrapperDom()&&this.layoutController.renderer.setStyle(t.getWrapperDom(),"transition",this.transition);var n=t.getChildren();n&&Object.values(n).forEach(function(t){return e.enableTransitions(t)})},t.prototype.getSortedElementList=function(t,e){var n=t.getChildren(),o=[];if(n){for(var i={},r=1e3,a=0,s=Object.values(n);a<s.length;a++){var l=s[a];if(!(l.positionConfig.hidden||0!==e&&e!==l.positionConfig.layer)){var p=l.positionConfig.index;(p<0||p+1e4 in i)&&(p=r++),i[p+1e4]=l}}Object.keys(i).sort().forEach(function(t){return o.push(i[t])})}return o},t.prototype.dump=function(t){console.log(t.getId(),t.activeState.width,t.activeState.height)},t.prototype.recalculateLayout=function(t,e){void 0!==this.rootEl.el.wrapperComponentRef&&(this.rootEl.renderer.setStyle(this.rootEl.getWrapperDom(),"width","100%"),this.rootEl.renderer.setStyle(this.rootEl.getWrapperDom(),"height","100%"),t=this.rootEl.getWrapperDom().offsetWidth,e=this.rootEl.getWrapperDom().offsetHeight,this.rootEl.setNextState({width:t,height:e,renderedContentWidth:t,renderedContentHeight:e,naturalWidth:t,naturalHeight:e}),"script"===this.rootEl.positionConfig.construction&&this.recalculateLayoutHelper(this.rootEl,0,0),this.rootEl.commitState(),this.rootEl.renderer.setStyle(this.rootEl.getWrapperDom(),"width","100%"),this.rootEl.renderer.setStyle(this.rootEl.getWrapperDom(),"height","100%"),this.rootEl.renderer.removeStyle(this.rootEl.getWrapperDom(),"max-width"),this.rootEl.renderer.removeStyle(this.rootEl.getWrapperDom(),"min-width"),this.rootEl.renderer.removeStyle(this.rootEl.getWrapperDom(),"max-height"),this.rootEl.renderer.removeStyle(this.rootEl.getWrapperDom(),"min-height"))},t.prototype.recalculateLayoutHelper=function(t,e,n){var o=this;if(t.applyMinMaxToNextStateNaturalSize(),0===e){var i=new Set;return Object.values(t.getChildren()).forEach(function(t){return i.add(t.positionConfig.layer)}),Array.from(i).sort().forEach(function(e){return o.recalculateLayoutHelper(t,e,e)}),void t.redraw()}var r,a,s=t.positionConfig.groupConfig.innerPadding,l=t.positionConfig.groupConfig.elementsPadding,p=t.getChildren(),c=[],u=[],h=[],d=-1,g=this.getSortedElementList(t,n);return(function(){var n=this,o=!1,i=void 0;f(),g.forEach(function(p){if("group"===p.getType()&&(p.setNextState({naturalWidth:0,naturalHeight:0}),p.positionConfig.selfSized?n.recalculateLayoutHelper(p,e,0):p.applyMinMaxToNextStateNaturalSize()),0!==p.positionConfig.sticky&&void 0!==i)return h.push({holder:i,sticker:p}),void(p.positionConfig.stickerHolder=i);var u=p.nextState.naturalWidth+2*l;p.setNextState({width:p.nextState.naturalWidth,height:p.nextState.naturalHeight}),(o||!p.positionConfig.append&&c[d].length>0&&(p.positionConfig.newline||a+u+s>t.nextState.naturalWidth))&&f(),c[d].push(p),p.setNextState({left:a+l,top:r+l,width:p.nextState.naturalWidth,height:p.nextState.naturalHeight,zIndex:10*e}),a+=u,o=p.positionConfig.eol,i=p})}).bind(this)(),c.forEach(function(e){if(!(t.nextState.naturalWidth-v(e)<1)){var n=!1;if(e.forEach(function(t){return n=n||0!==t.positionConfig.fillX}),n){var o,i=t.nextState.naturalWidth-2*s;if(y(i,e)<=t.nextState.naturalWidth)o=i;else for(o=0;i-o>=.001;){var r=(i+o)/2;y(r,e)<=t.nextState.naturalWidth?o=r:i=r}a=s,e.forEach(function(t){t.nextState.left=a+l,t.nextState.width=C(o,e,t),a+=t.nextState.width+2*l})}}}),function(){var e=[];if(c.forEach(function(t,n){for(var o=0;o<t.length;o++)if(t[o].positionConfig.fillY){e.push(n);break}}),0!==e.length){var n,o=t.nextState.naturalHeight-2*s,i=o;if(x(o)<=t.nextState.naturalHeight)n=o;else for(n=0;o-n>=.001;){var a=(o+n)/2;x(a)<=t.nextState.naturalHeight?n=a:o=a}e.forEach(function(t){var e=b(n,t);c[t].forEach(function(t){if(0!==t.positionConfig.fillY){var n=t.positionConfig.fillY*i/100;n<t.nextState.height&&(n=t.nextState.height),t.nextState.height=Math.min(-1===t.positionConfig.maxH?n:t.positionConfig.maxH,n,e)}})}),r=s,c.forEach(function(t){t.forEach(function(t){return t.nextState.top=r+l}),r+=m(t)})}}(),c.forEach(function(e){for(var n=t.nextState.naturalWidth-v(e),o=0;o<e.length&&n>0;o++){var i=e[o];if(i.positionConfig.alignRight){for(var r=o;r<e.length;r++)e[r].nextState.left+=n;break}if(i.positionConfig.alignCenter){var a=(t.nextState.naturalWidth-i.nextState.width)/2;if(a<=i.nextState.left)continue;var s=a-i.nextState.left;for(s>n&&(s=n),r=o;r<e.length;r++)e[r].nextState.left+=s;n-=s}}}),(function(){r=s,c.forEach(function(t){u.push(r+l);var e=m(t)-2*l;t.forEach(function(t){t.positionConfig.alignMiddle&&(t.nextState.top=(e-t.nextState.height)/2+r+l),t.positionConfig.alignBottom&&(t.nextState.top=e-t.nextState.height+r+l)}),r+=e+2*l}),t===this.rootEl&&(r+=s)>t.nextState.height&&(t.nextState.height=r)}).bind(this)(),function(){var e=2*s;c.forEach(function(t){return e+=m(t)});for(var n=t.nextState.naturalHeight-e,o=function(e){var o=!1,i=!1;if(c[e].forEach(function(t){o=o||t.positionConfig.lineAlignBottom,i=i||t.positionConfig.lineAlignMiddle}),o){for(var r=e;r<c.length;r++)c[r].forEach(function(t){return t.nextState.top+=n});return"break"}if(i){var a=(t.nextState.naturalHeight-m(c[e]))/2+l;if(a<=u[e])return"continue";var s=a-u[e];for(s>n&&(s=n),r=e;r<c.length;r++)c[r].forEach(function(t){return t.nextState.top+=s}),u[r]+=s;n-=s}},i=0;i<c.length&&n>0&&"break"!==o(i);i++);}(),(function(){t.positionConfig.groupConfig.pageCenter&&c.forEach(function(e){var n=v(e);if(n<t.nextState.naturalWidth){var o=(t.nextState.naturalWidth-n)/2;e.forEach(function(t){return t.nextState.left+=o})}})}).bind(this)(),(function(){if(t.positionConfig.groupConfig.pageMiddle){var e=0;if(g.forEach(function(t){var n=t.nextState.top+t.nextState.height-1+l;n>e&&(e=n)}),!(e>=t.nextState.naturalHeight-s-1)){var n=(t.nextState.naturalHeight-s-1-e)/2;g.forEach(function(t){return t.nextState.top+=n})}}}).bind(this)(),(function(){h.forEach(function(t){var n,o,i,r=t.sticker.positionConfig.sticky;if(t.sticker.positionConfig.stickyFloat){var a=t.sticker.nextState.naturalHeight/2;(i=Math.max(t.sticker.getParent().positionConfig.groupConfig.innerPadding,t.sticker.getParent().positionConfig.groupConfig.elementsPadding)+t.sticker.getParent().positionConfig.groupConfig.elementsPadding)>2&&(i-=2),i>a&&(i=a),n=0!=(32&r)?t.holder.nextState.top-i:0!=(8&r)?t.holder.nextState.top+t.holder.nextState.height+i-t.sticker.nextState.naturalHeight:t.holder.nextState.top+t.holder.nextState.height/2-t.sticker.nextState.naturalHeight/2}else n=0!=(32&r)?t.holder.nextState.top:0!=(8&r)?t.holder.nextState.top+t.holder.nextState.height-t.sticker.nextState.naturalHeight:t.holder.nextState.top+t.holder.nextState.height/2-t.sticker.nextState.naturalHeight/2;t.sticker.positionConfig.stickyFloat?(a=t.sticker.nextState.naturalWidth/2,(i=Math.max(t.sticker.getParent().positionConfig.groupConfig.innerPadding,t.sticker.getParent().positionConfig.groupConfig.elementsPadding)+t.sticker.getParent().positionConfig.groupConfig.elementsPadding)>2&&(i-=2),i>a&&(i=a),o=0!=(4&r)?t.holder.nextState.left-i:0!=(1&r)?t.holder.nextState.left+t.holder.nextState.width+i-t.sticker.nextState.naturalWidth:t.holder.nextState.left+t.holder.nextState.width/2-t.sticker.nextState.naturalWidth/2):o=0!=(4&r)?t.holder.nextState.left:0!=(1&r)?t.holder.nextState.left+t.holder.nextState.width-t.sticker.nextState.naturalWidth:t.holder.nextState.left+t.holder.nextState.width/2-t.sticker.nextState.naturalWidth/2,t.sticker.setNextState({left:o,top:n,width:t.sticker.nextState.naturalWidth,height:t.sticker.nextState.naturalHeight,transition:"left 0.3s, top 0.3s, width 0.3s, height 0.3s, max-width 0.3s, min-width 0.3s, max-height 0.3s, min-height 0.3s",zIndex:10*e+(t.sticker.positionConfig.stickyBehind?-1:1)}),t.sticker.positionConfig.stickyAuto&&(t.sticker.renderer.setStyle(t.sticker.getWrapperDom(),"display","none"),0===t.holder.positionConfig.autoStickers.length&&(t.holder.positionConfig.sickerListeners||(t.holder.listenEvent("mouseenter"),t.holder.listenEvent("mouseleave"),t.holder.positionConfig.sickerListeners=!0)),t.holder.positionConfig.autoStickers.push(t.sticker),t.sticker.positionConfig.sickerListeners||(t.sticker.listenEvent("mouseenter"),t.sticker.listenEvent("mouseleave"),t.sticker.positionConfig.sickerListeners=!0))})}).bind(this)(),(function(){g.forEach(function(t){t.commitState()})}).bind(this)(),(function(){var t=this;g.forEach(function(n){"group"===n.getType()&&(n.positionConfig.selfSized||(n.setNextState({naturalWidth:n.nextState.width,naturalHeight:n.nextState.height}),t.recalculateLayoutHelper(n,e,0)))})}).bind(this)(),void(function(){if(t!==this.rootEl&&t.redraw(),t.positionConfig.selfSized){var e=0,n=0;c.forEach(function(t){return e=Math.max(e,v(t))}),g.forEach(function(t){return n=Math.max(n,t.nextState.top+t.nextState.height)}),t.setNextState({naturalWidth:e,naturalHeight:n+=l+s,width:e,height:n})}}).bind(this)();function f(){d<0?(r=s,a=s):(a=s,r+=m(c[d])),d++,c.push([])}function m(t){var e=0;return t.forEach(function(t){t.nextState.height>e&&(e=t.nextState.height)}),e+2*l}function v(t){var e=2*s;return t.forEach(function(t){return e+=t.nextState.width+2*l}),e}function y(t,e){var n=2*s;return e.forEach(function(o){return n+=C(t,e,o)+2*l}),n}function C(t,e,n){if(0===n.positionConfig.fillX)return n.nextState.width;if(""!==n.positionConfig.clone){var o=void 0;for(o=0;o<e.length&&e[o].getId()!==n.positionConfig.clone;o++);if(o===e.length)return p[n.positionConfig.clone].nextState.width}var i=n.positionConfig.fillX*t/100-2*l;return i<n.nextState.width&&(i=n.nextState.width),Math.min(-1===n.positionConfig.maxW?i:n.positionConfig.maxW,i)}function x(t){for(var e=2*s,n=0;n<c.length;n++)e+=b(t,n)+2*l;return e}function b(t,e){var n=0;return c[e].forEach(function(e){var o;if(0!==e.positionConfig.fillY){var i=e.positionConfig.fillY*t/100;i<e.nextState.height&&(i=e.nextState.height),o=Math.min(-1===e.positionConfig.maxH?i:e.positionConfig.maxH,i)}else o=e.nextState.height;o>n&&(n=o)}),n}},t.prototype.initEl=function(t,e,n){var o,i=this;void 0===e&&(e=!1),void 0===n&&(n=!1);var r=0,s=0;t.getScrolledDom()&&(r=t.getScrolledDom().scrollTop,s=t.getScrolledDom().scrollLeft);var l=null===(o=t.positionConfig)||void 0===o?void 0:o.calculated;t.setupConfig(),t.positionConfig.calculated=Object(a.isNil)(l)?t.positionConfig.calculated:l;var p=t.positionConfig;e&&(p.calculated=3);var c=t.calculateNaturalSize();if(void 0!==c){if(t.setNextState({naturalWidth:c.width,naturalHeight:c.height,renderedContentWidth:c.width,renderedContentHeight:c.height,width:c.width,height:c.height,transition:1!==p.calculated&&2!==p.calculated||n?this.transitionNone:this.transition}),p.hidden?t.renderer.setStyle(t.getWrapperDom(),"display","none"):t.renderer.removeStyle(t.getWrapperDom(),"display"),t!==this.rootEl&&!a.isNil(p))switch(this.rootEl.positionConfig.construction){case"script":t.setNextState({zIndex:1,width:c.width,height:c.height,opacity:1});break;default:t.setNextState({zIndex:1,left:p.x,top:p.y,width:p.w,height:p.h,opacity:1}),t.commitState()}var u=t.getChildren();if(u&&Object.values(u).forEach(function(t){return i.initEl(t,e,n)}),t===this.rootEl&&(this.isDragging||this.recalculateLayout(t.getWrapperDom().offsetWidth,t.getWrapperDom().offsetHeight),this.maintenanceActivated||(this.maintenanceActivated=!0,this.timeouts.push(setTimeout(function(){return i.maintenance()},this.maintenanceFrequency)))),t.getScrolledDom()){t.getScrolledDom();var h=t.getScrolledDom().style["scroll-behavior"];this.layoutController.renderer.setStyle(t.getScrolledDom(),"scroll-behavior","auto"),t.getScrolledDom().scrollTop=r,t.getScrolledDom().scrollLeft=s,this.layoutController.renderer.setStyle(t.getScrolledDom(),"scroll-behavior",h)}}},t.prototype.maintenance=function(){var t=this;this.isDragging||(this.maintenanceCounter++,this.maintenanceHelperRoot(),this.maintenanceHelperTables(this.rootEl)),this.timeouts.push(setTimeout(function(){return t.maintenance()},this.maintenanceFrequency))},t.prototype.maintenanceHelperRoot=function(){this.rootEl.activeState.width!=this.rootEl.getWrapperDom().offsetWidth||this.rootEl.activeState.height!=this.rootEl.getWrapperDom().offsetHeight?(this.maintenanceRootSizeMismatch++,3==this.maintenanceRootSizeMismatch&&(this.recalculateLayout(this.rootEl.getWrapperDom().offsetWidth,this.rootEl.getWrapperDom().offsetHeight),this.maintenanceRootSizeMismatch=0)):this.maintenanceRootSizeMismatch=0},t.prototype.maintenanceHelperTables=function(t){var e=this;if(this.maintenanceCounter%3==0){"table"===t.getType()&&t.getWrapper().redraw$.next();var n=t.getChildren();n&&Object.values(n).forEach(function(t){return e.maintenanceHelperTables(t)})}},t.prototype.onGroupScroll=function(t){t.getScrolledDom(),this.layoutController.getControl()&&this.layoutController.getControl().update()},t.prototype.onUpdate=function(t,e,n,o){this.initEl(this.rootEl)},t.prototype.onElementEvent=function(t,e,n){var o=this;switch(e){case"mouseenter":this.activeElements.includes(t)||this.activeElements.push(t),this.timeouts.push(setTimeout(function(){var e=o.activeElements.includes(t);t.positionConfig.autoStickers.forEach(function(t){e=e||o.activeElements.includes(t)}),e&&t.positionConfig.autoStickers.forEach(function(t){t.renderer.removeStyle(t.getWrapperDom(),"display")})},300));break;case"mouseleave":var i=this.activeElements.indexOf(t);i>=0&&this.activeElements.splice(i,1),t.positionConfig.autoStickers.length>0&&this.timeouts.push(setTimeout(function(){return o.hideAutoStickers(t)},150)),void 0!==t.positionConfig.stickerHolder&&this.timeouts.push(setTimeout(function(){return o.hideAutoStickers(t.positionConfig.stickerHolder)},150))}},t.prototype.onElementDestroy=function(t){var e=this.activeElements.indexOf(t);e>=0&&this.activeElements.splice(e,1)},t.prototype.hideAutoStickers=function(t){var e=this;if(!this.activeElements.includes(t)){var n=!1;t.positionConfig.autoStickers.forEach(function(t){n=n||e.activeElements.includes(t)}),n||t.positionConfig.autoStickers.forEach(function(t){t.renderer.setStyle(t.getWrapperDom(),"display","none")})}},t.prototype.onElementSizeChanged=function(t,e){if(this.elementSizeChanged$.next({el:t,size:e}),1===t.positionConfig.calculated)return t.positionConfig.lastKnownSizeW=e.width,t.positionConfig.lastKnownSizeH=e.height,void(t.positionConfig.calculated=2);if(t.positionConfig.lastKnownSizeW!==e.width||t.positionConfig.lastKnownSizeH!==e.height){if(t.positionConfig.calculated=3,t.positionConfig.lastKnownSizeW=e.width,t.positionConfig.lastKnownSizeH=e.height,t!==this.rootEl&&"group"===t.getType())return;var n=t.calculateNaturalSize();if(null==n)return;t.setNextState({naturalWidth:n.width,naturalHeight:n.height,renderedContentWidth:n.width,renderedContentHeight:n.height,width:n.width,height:n.height}),this.recalculateLayout(this.rootEl.getWrapperDom().offsetWidth,this.rootEl.getWrapperDom().offsetHeight)}},t.prototype.getIndexForMousePosition=function(t,e){var n=t.getLocalMousePosition(),o=t.getScrolledDom().scrollTop,i=t.getScrolledDom().scrollLeft;n.x=n.x+i,n.y=n.y+o;for(var r=e.length,a=-1,s=!1,l=0;l<e.length;l++){var p=e[l].activeState,c=p.left+p.width/2,u=p.top+p.height;if(n.x<c&&n.y<u){var h=e[l-1];if(r=l,a=l>0?-1:0,s=!(l>0),h&&h.activeState.top<p.top){a=0,s=!0;break}break}if(n.x>c&&n.y<u){var d=e[l+1];if(d&&(null==d?void 0:d.activeState.top)>p.top){r=l+1,a=-1;break}}}return{index:r,indicatorOffset:a,isBefore:s}},t.prototype.onDragStart=function(t,e,n,o){var i,r;void 0===o&&(o=null),this.isDragging=!0;var s=null===(r=null===(i=t.getLayout())||void 0===i?void 0:i.draggable)||void 0===r?void 0:r.type;o&&(s=o),this.dragStart$.next({el:t,data:e,control:n}),n.show();var l=this.tempElements[t.getId()+"__dragStartPos"];l&&(l.destroy(),delete this.tempElements[t.getId()+"__dragStartPos"]),this.tempElements[t.getId()+"__dragStartPos"]=this.layoutController.createTempEl(t.nextState,{"background-color":"rgba(var(--theme-primary-500),0.2)",border:"0px dotted rgba(var(--theme-primary-500),0.2)"},t.getParent(),"clone"===s?t:null,"clone"===s?{opacity:.5}:null);var p=this.layoutController.getPositionDiff(t,this.rootEl);this.layoutController.moveVisuallyToGroup(t,this.rootEl),t.setNextState({left:t.nextState.left+p.left,top:t.nextState.top+p.top,transition:this.transitionNone,opacity:.5}),t.dragStartState=Object(a.cloneDeep)(t.nextState),t.updateState(),n.applyBgStyle({cursor:"grabbing"})},t.prototype.onDrag=function(t,e,n,o){void 0===o&&(o=null),this.layoutController.dragDisabled=!0;var i,r,a=this.determineTargetGroup(t,this.layoutController.mousePos.x,this.layoutController.mousePos.y),s=this.tempElements[t.getId()+"__dragStartPos"];a!==this.dragTempData.prevTargetGroup?(r=this.dragTempData.tempTargetSortedChildren=this.getSortedElementList(a,0),(i=this.dragTempData.prevCanDrop=this.canBeDropped(t,a))?(this.layoutController.renderer.removeClass(n.elRef.nativeElement,"cantDrop"),n.applyBgStyle({cursor:"grabbing"}),s.applyStyles({"background-color":"rgba(var(--theme-primary-500),0.2)","border-color":"rgba(var(--theme-primary-500),0.2)","border-style":"dotted","background-image":"none","border-radius":"3px"})):(this.layoutController.renderer.addClass(n.elRef.nativeElement,"cantDrop"),n.applyBgStyle({cursor:"no-drop"}),s.applyStyles({"background-color":"rgba(var(--theme-warn-500),0.5)","border-color":"rgba(var(--theme-warn-500),1)","border-style":"solid","background-image":"repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(var(--theme-warn-500),0.5) 5px, rgba(var(--theme-warn-500),0.5) 10px)"})),this.dragTempData.prevCanDrop=i):(r=this.dragTempData.tempTargetSortedChildren,i=this.dragTempData.prevCanDrop);var l=this.getIndexForMousePosition(a,r);this.layoutController.updateDropIndicator(a,r[l.index+l.indicatorOffset],l.isBefore,s,i),t.setNextState({left:t.dragStartState.left+e.deltaX,top:t.dragStartState.top+e.deltaY,opacity:i?.5:.2,transition:"none"}),t.updateState()},t.prototype.onDragEnd=function(t,e,n,o){var i,r,a=this;void 0===o&&(o=null),this.isDragging=!1,this.dragEnd$.next({el:t,data:e,control:n});var s=this.determineTargetGroup(t,this.layoutController.mousePos.x,this.layoutController.mousePos.y),l=null===(r=null===(i=t.getLayout())||void 0===i?void 0:i.draggable)||void 0===r?void 0:r.type;o&&(l=o);var p=this.tempElements[t.getId()+"__dragStartPos"];if(this.canBeDropped(t,s)&&"clone"!==l&&"fake"!==l){var c=this.layoutController.getRelativePos(t,s);t.setNextState({left:c.left,top:c.top,opacity:t.dragStartState.opacity,transition:this.transition});var u=this.getSortedElementList(s,0),h=this.getIndexForMousePosition(s,u);this.layoutController.moveToGroup(t,s,h.index,l),t.commitState(),p.destroy(),n.hide(),delete this.tempElements[t.getId()+"__dragStartPos"],this.initEl(this.rootEl,!0),this.timeouts.push(setTimeout(function(){n.update(),a.layoutController.dragDisabled=!1},400))}else{n.hide();var d=function(){p&&(p.destroy(),delete a.tempElements[t.getId()+"__dragStartPos"]),t.resetState(),n.update(),n.hide(),a.layoutController.moveVisuallyToGroup(t,t.getParent())};!this.canBeDropped(t,s)||"clone"!==l&&"fake"!==l?(t.setNextState({left:t.dragStartState.left,top:t.dragStartState.top,opacity:t.dragStartState.opacity,transition:this.transition}),t.updateState()):(u=this.getSortedElementList(s,0),h=this.getIndexForMousePosition(s,u),this.layoutController.moveToGroup(t,s,h.index,l),d()),this.timeouts.push(setTimeout(function(){d(),a.initEl(a.rootEl,!0),a.layoutController.dragDisabled=!1,a.isDragging=!1},400))}this.dragTempData={}},t.prototype.onScaleStart=function(t,e,n){this.isDragging=!0,console.log("onScaleStart",e)},t.prototype.onScale=function(t,e,n){console.log("onScale",e),t.setNextState({width:t.activeState.width+e.deltaX,height:t.activeState.height+e.deltaY,transition:"none"}),t.updateState(),n.update()},t.prototype.onScaleEnd=function(t,e,n){this.isDragging=!1,t.getConfig().layout.w=t.activeState.width+e.deltaX,t.getConfig().layout.h=t.activeState.height+e.deltaY,t.commitState(),this.initEl(this.rootEl,!0)},t.prototype.canBeDropped=function(t,e){var n,o,i,r,a,s,l,p,c=e.getLayout(),u=t.getLayout();if((null===(o=null===(n=null==c?void 0:c.dropzone)||void 0===n?void 0:n.acceptKeys)||void 0===o?void 0:o.indexOf("*"))>=0||(null===(r=null===(i=null==u?void 0:u.draggable)||void 0===i?void 0:i.hasKeys)||void 0===r?void 0:r.indexOf("*"))>=0)return!0;if(null===(a=null==c?void 0:c.dropzone)||void 0===a?void 0:a.acceptKeys){if(null===(s=null==u?void 0:u.draggable)||void 0===s?void 0:s.hasKeys){for(var h=0,d=null===(l=u.draggable)||void 0===l?void 0:l.hasKeys;h<d.length;h++)if((null===(p=c.dropzone)||void 0===p?void 0:p.acceptKeys.indexOf(d[h]))>=0)return!0;return!1}return!1}return!1},t.prototype.determineTargetGroup=function(t,e,n){return this.findGroupAtPos(t,this.rootEl,e,n)||this.rootEl},t.prototype.findGroupAtPos=function(t,e,n,o){if("group"!==e.getType())return null;var i=e.getChildren();if(i)for(var r=void 0,a=Object.keys(i),s=0;s<a.length;s++)if(r=this.findGroupAtPos(t,i[a[s]],n,o))return r;var l=e.getWrapperDom().getBoundingClientRect();return n>l.left&&n<l.left+l.width&&o>l.top&&o<l.top+l.height&&e!==t?e:null},t.prototype.destroy=function(){var t=this;this.unlistenLoadingDone&&this.unlistenLoadingDone(),this.destroy$.next(),this.timeouts.forEach(function(t){clearTimeout(t)}),Object.keys(this.tempElements).forEach(function(e){t.tempElements[e].destroy()})},t}(),y=function(){function t(t){this.rootEl=t,this.dragDisabled=!1,this.activeElementEngaged=!1,this.controlsDestroyed$=new p.Subject,this.destroy$=new p.Subject,this.mousePos={x:0,y:0}}return t.prototype.init=function(){var t=this;this.renderer=this.rootEl.renderer,this.cfr=this.rootEl.el.cfr,this.rootGroup=this.rootEl.el.pluginComponentRef.instance,this.rootVC=this.rootGroup.targetVC,this.mouseMoveListener=this.renderer.listen(window,"mousemove",function(e){t.mousePos.x=e.clientX,t.mousePos.y=e.clientY}),this.positionController=new v(this.rootEl,this),this.rootEl.init(this),this.positionController.init()},t.prototype.getControl=function(){var t;return null===(t=this.controls)||void 0===t?void 0:t.instance},t.prototype.onUpdate=function(t,e,n,o){this.rootEl.update(this),this.positionController.onUpdate(t,e,n,o)},t.prototype.activate=function(t){this.activeEl&&this.activeEl===t||(this.activeEl=t,this.createControls(),t.control=this.controls.instance,this.setControlPos(t),this.controls.instance.setSize({width:t.activeState.width,height:t.activeState.height}))},t.prototype.deactivate=function(t){void 0===t&&(t=null),t!==this.activeEl&&null!==t||(this.activeElementEngaged=!1,this.activeEl=null,t&&(t.control=null),this.destroyControls())},t.prototype.updateControl=function(){this.activeEl&&(this.setControlPos(this.activeEl),this.setControlSize({width:this.activeEl.nextState.width,height:this.activeEl.nextState.height}))},t.prototype.setControlPos=function(t){if(this.controls){var e=this.getRelativePos(t,this.rootEl);e.left+=this.controls.location.nativeElement.parentElement.scrollLeft,e.top+=this.controls.location.nativeElement.parentElement.scrollTop,this.controls.instance.setPos({top:e.top,left:e.left})}},t.prototype.setControlSize=function(t){this.controls.instance.setSize({width:t.width,height:t.height})},t.prototype.getRelativePos=function(t,e){var n=t.getWrapperDom().getBoundingClientRect(),o=e.el.pluginComponentRef.instance.wrapperEl.nativeElement.getBoundingClientRect();return{top:n.top-o.top,left:n.left-o.left}},t.prototype.getLocalPosition=function(t,e){var n=t.getBoundingClientRect(),o=e.getBoundingClientRect();return{top:n.top-o.top,left:n.left-o.left,bottom:n.bottom-o.top,right:n.right-o.left}},t.prototype.createDropIndicator=function(){this.dropIndicator=this.renderer.createElement("div");var t=this.rootGroup.wrapperEl.nativeElement;this.renderer.setStyle(this.dropIndicator,"width","5px"),this.renderer.setStyle(this.dropIndicator,"height","30px"),this.renderer.setStyle(this.dropIndicator,"border-radius","30px"),this.renderer.setStyle(this.dropIndicator,"background","rgba(var(--theme-accent-500),0.5)"),this.renderer.setStyle(this.dropIndicator,"transform","translateX(-50%) translateY(-50%)"),this.renderer.setStyle(this.dropIndicator,"position","absolute"),this.renderer.setStyle(this.dropIndicator,"z-index","9999999999"),this.renderer.setStyle(this.dropIndicator,"display","none"),this.renderer.setStyle(this.dropIndicator,"pointer-events","none"),this.renderer.appendChild(t,this.dropIndicator)},t.prototype.updateDropIndicator=function(t,e,n,o,i){var r,a;void 0===n&&(n=!1);var s=null===(a=null===(r=t.getConfig().config)||void 0===r?void 0:r.layoutConfig)||void 0===a?void 0:a.elementsPadding;if(s||(s=0),this.dropIndicator&&e&&i){var l=e.getWrapperDom();e===this.activeEl&&o&&(l=o.getWrapperDom());var p=(c=this.getLocalPosition(l,this.dropIndicator.parentElement)).right-c.left;this.renderer.setStyle(this.dropIndicator,"display","inline-block"),this.renderer.setStyle(this.dropIndicator,"width",(s>3?s:3)+"px"),this.renderer.setStyle(this.dropIndicator,"left",c.left+(n?-s:p+s)+"px"),this.renderer.setStyle(this.dropIndicator,"top",c.top+e.getWrapperDom().offsetHeight/2+"px"),this.renderer.setStyle(this.dropIndicator,"height",e.getWrapperDom().offsetHeight+"px")}else if(this.dropIndicator&&i){var c=this.getLocalPosition(t.getWrapperDom(),this.dropIndicator.parentElement);this.renderer.setStyle(this.dropIndicator,"display","inline-block"),this.renderer.setStyle(this.dropIndicator,"width",(s>3?s:3)+"px"),this.renderer.setStyle(this.dropIndicator,"left",c.left+s+"px"),this.renderer.setStyle(this.dropIndicator,"top",c.top+s+o.getWrapperDom().offsetHeight/2+"px"),this.renderer.setStyle(this.dropIndicator,"height",o.getWrapperDom().offsetHeight+"px")}else this.renderer.setStyle(this.dropIndicator,"display","none")},t.prototype.destroyDropIndicator=function(){this.dropIndicator&&this.renderer.removeChild(this.dropIndicator.parentElement,this.dropIndicator),this.dropIndicator=null},t.prototype.getNearestEditButtons=function(t){var e,n,o,i,r=null===(i=null===(o=null===(n=null===(e=t.getParentContext())||void 0===e?void 0:e.pluginConfig)||void 0===n?void 0:n.config)||void 0===o?void 0:o.layoutConfig)||void 0===i?void 0:i.editButtons;return!r&&t!==t.getRoot()&&t.getParent()&&(r=this.getNearestEditButtons(t.getParent())),r},t.prototype.createControls=function(){var t,e,n,o=this,i=this.cfr.resolveComponentFactory(m);this.controls&&this.destroyControls();var r=this.rootGroup.targetVC.createComponent(i,void 0,this.rootEl.el.injector);r.instance.wrapperEl=this.rootGroup.wrapperEl,r.instance.draggable=null===(t=this.activeEl.getLayout())||void 0===t?void 0:t.draggable,r.instance.hideControls=!!Object(a.isNil)(null===(e=this.activeEl.getLayout())||void 0===e?void 0:e.hideControls)||(null===(n=this.activeEl.getLayout())||void 0===n?void 0:n.hideControls),r.instance.layoutController=this,r.instance.editButtons=this.getNearestEditButtons(this.activeEl);var s=this.activeEl;this.subscribeToElementControlEvent(r.instance.dragStart$,function(t){var e;s.isDragging=!0,o.activeElementEngaged=!0,o.positionController.onDragStart(s,t.data,o.controls.instance,null===(e=t.editButton)||void 0===e?void 0:e.supportDrag),o.setControlPos(s),o.renderer.setStyle(o.activeEl.getWrapperDom(),"pointer-events","none"),o.createDropIndicator()}),this.subscribeToElementControlEvent(r.instance.drag$,function(t){var e;s.isDragging=!0,o.positionController.onDrag(s,t.data,o.controls.instance,null===(e=t.editButton)||void 0===e?void 0:e.supportDrag),o.setControlPos(s)}),this.subscribeToElementControlEvent(r.instance.dragEnd$,function(t){var e;s.isDragging=!1,o.renderer.removeStyle(o.activeEl.getWrapperDom(),"pointer-events"),o.setControlPos(s),o.positionController.onDragEnd(s,t.data,o.controls.instance,null===(e=t.editButton)||void 0===e?void 0:e.supportDrag),o.activeElementEngaged=!1,o.destroyDropIndicator()}),this.subscribeToElementControlEvent(r.instance.scaleStart$,function(t){o.activeElementEngaged=!0,o.positionController.onScaleStart(s,t.data,o.controls.instance)}),this.subscribeToElementControlEvent(r.instance.scale$,function(t){o.positionController.onScale(s,t.data,o.controls.instance)}),this.subscribeToElementControlEvent(r.instance.scaleEnd$,function(t){o.activeElementEngaged=!1,o.positionController.onScaleEnd(s,t.data,o.controls.instance)}),this.subscribeToElementControlEvent(r.instance.buttonEvent$,function(t){var e={};e.path=o.activeEl.getWrapper().getPathString(),e.editButton=t.editButton,o.activeElementEngaged=!0,o.activeEl.getParent().getPlugin().instance.editButtonEvent$.next(e)}),this.subscribeToElementControlEvent(r.instance.mouseLeave$,function(t){s.handleMouseLeave()}),this.controls=r},t.prototype.destroyControls=function(){this.destroyDropIndicator(),this.controls&&(this.controlsDestroyed$.next(),this.controls.destroy(),this.controls=null)},t.prototype.moveToGroup=function(t,e,n,o){var i;if("group"!==e.getConfig().type)return console.error("Can't move to group since targetEl is not a group ",t.getId(),e.getId());t.getParent()===e&&(null===(i=t.getLayout())||void 0===i?void 0:i.index)<n&&"clone"!==o&&(n-=1),("move"===o||Object(a.isNil)(o))&&t.getParentContext().pluginComponentRef.instance.detachPlugin(this.activeEl.getId());var r=t.getWrapper().getPathString();e.el.pluginComponentRef.instance.attachPlugin(this.activeEl.getId(),this.activeEl,n,r,o)},t.prototype.getPositionDiff=function(t,e){var n=e.el.pluginComponentRef.instance,o=t.getWrapperDom().parentElement.getBoundingClientRect(),i=t.getWrapperDom().parentElement,r=n.targetVC.element.nativeElement.parentElement,a=r.getBoundingClientRect();return{left:o.left-a.left-i.scrollLeft+r.scrollLeft,top:o.top-a.top-i.scrollTop+r.scrollTop}},t.prototype.moveVisuallyToGroup=function(t,e){var n=e.el.pluginComponentRef.instance.targetVC,o=t.el.wrapperComponentRef.hostView,i=t.getParentVC().indexOf(o);i>=0&&(t.getParentVC().detach(i),n.insert(o),t.el.currentParentContext=e.el)},t.prototype.createTempEl=function(t,e,n,o,i){var r=this;void 0===n&&(n=this.rootEl),void 0===o&&(o=null),void 0===i&&(i=null);var s=this.cfr.resolveComponentFactory(n.el.pluginCreator.getPluginWrapperComponent()),l=n.getTargetVC().createComponent(s,void 0,n.el.injector),p=l.instance;if(p.wrapperComponentRef=l,o){var u=o.getWrapperDom().cloneNode(!0);this.renderer.appendChild(p.wrapperComponentRef.location.nativeElement,u),this.renderer.removeStyle(u,"left"),this.renderer.removeStyle(u,"top"),i&&Object.keys(i).forEach(function(t){r.renderer.setStyle(u,t,i[t])})}Object.assign({position:"absolute",styles:e});var h=new c(p);return h.setNextState(Object(a.cloneDeep)(t)),h.commitState(),h.applyStyles(e),h},t.prototype.moveToVC=function(t,e,n){var o=t.getWrapperDom().getBoundingClientRect(),i=n.element.nativeElement.parentElement.getBoundingClientRect(),r={top:o.top-i.top,left:o.left-i.left,width:o.width,height:o.height},a=t.el.wrapperComponentRef.hostView,s=e.indexOf(a);s>=0&&(e.detach(s),n.insert(a)),t.nextState.left=r.left,t.nextState.top=r.top,t.commitState()},t.prototype.findWrapperDivParent=function(t,e){var n,o=this,i=t.getChildren();return i&&Object.keys(i).forEach(function(t){var r=o.findWrapperDivParent(i[t],e);r&&(n=r)}),"group"===t.getConfig().type&&t.el.pluginComponentRef.instance.wrapperEl.nativeElement===e&&(n=t),n},t.prototype.destroy=function(){this.mouseMoveListener&&this.mouseMoveListener(),this.positionController&&this.positionController.destroy(),this.destroy$.next()},t.prototype.subscribeToElementControlEvent=function(t,e){t.pipe(Object(l.takeUntil)(this.controlsDestroyed$)).subscribe(e)},t}(),C=["targetVC"],x=["wrapperRef"];function b(t,e){}var S=function(){function t(t,e,n,o,i,r,a,s,l){this.cfr=t,this.injector=e,this.overlay=n,this.overlayContainer=o,this.renderer=i,this.elRef=r,this.hostVC=a,this.cd=s,this.context=l,this.children={},this.layoutElements={},this.elementAdded$=new p.Subject,this.elementRemoved$=new p.Subject,this.editButtonEvent$=new p.Subject,this.redraw=new p.Subject,this.counter=0,this.isBuilding=!1}return t.prototype.ngOnInit=function(){var t=this;this.createPluginWrappers(),this.context.update$.pipe(Object(l.takeUntil)(this.context.destroy$)).subscribe(function(e){t.pluginOnUpdate(e.prevConfig,e.newConfig,e.compareResult,e.commands),t.layoutController&&t.layoutController.onUpdate(e.prevConfig,e.newConfig,e.compareResult,e.commands)}),this.elementAdded$.pipe(Object(l.takeUntil)(this.context.destroy$)).subscribe(function(e){t.context.firePluginInteractions("elementAdded",e).subscribe();var n=t.context.parentContext;n&&n!==t.context&&"group"===n.pluginConfig.type&&n.pluginComponentRef.instance.elementAdded$.next(e)}),this.elementRemoved$.pipe(Object(l.takeUntil)(this.context.destroy$)).subscribe(function(e){t.context.firePluginInteractions("elementRemoved",e).subscribe();var n=t.context.parentContext;n&&n!==t.context&&"group"===n.pluginConfig.type&&n.pluginComponentRef.instance.elementRemoved$.next(e)}),this.editButtonEvent$.pipe(Object(l.takeUntil)(this.context.destroy$)).subscribe(function(e){t.context.firePluginInteractions("editButtonEvent",e).subscribe();var n=t.context.parentContext;n&&n!==t.context&&"group"===n.pluginConfig.type&&n.pluginComponentRef.instance.editButtonEvent$.next(e)})},t.prototype.detachPlugin=function(t){this.context.control.removeControl(t);var e=this.children[t].currentParentContext.pluginComponentRef.instance.targetVC,n=e.indexOf(this.children[t].wrapperComponentRef.hostView);n>-1&&e.detach(n),this.children[t].parentContext=null,this.children[t].currentParentContext=null,delete this.children[t],delete this.layoutElements[t],delete this.context.pluginConfig.config.elements[t],this.elementRemoved$.next({removedElement:t})},t.prototype.attachPlugin=function(t,e,n,o,i){if("fake"!==i){if(this.children[t]){var r=(t=t.split("*")[0])+"*"+this.counter++;console.warn("Child with same id already exists in group. id:",t,"group:",this.context.getPathString(),"Renaming to: ",r),t=r}if(Object(a.isNil)(this.context.pluginConfig.config)&&(this.context.pluginConfig.config={}),Object(a.isNil)(this.context.pluginConfig.config.elements)&&(this.context.pluginConfig.config.elements={}),this.reindex(n),Object(a.isNil)(i)||"move"===i){this.children[t]=e.el,this.layoutElements[t]=e;var s=this.children[t].wrapperComponentRef.hostView;this.targetVC.indexOf(s)<0&&this.targetVC.insert(s),this.children[t].currentParentContext=this.context,this.children[t].parentContext=this.context,this.context.control.addControl(t,e.el.control),this.context.pluginConfig.config.elements[t]=e.el.pluginConfig}else if("clone"===i){var l=Object(a.cloneDeep)(e.el.pluginConfig);this.children[t]=this.createPlugin(t,l,n),this.context.pluginConfig.config.elements[t]=l,this.layoutElements[t].init(this.layoutElement.getLayoutController());var p=this.layoutElement.getLayoutController().getRelativePos(e,this.layoutElement);this.layoutElements[t].setNextState(Object(a.cloneDeep)(e.nextState)),this.layoutElements[t].setNextState({top:p.top,left:p.left}),this.layoutElements[t].updateState(),this.layoutElements[t].positionConfig=Object(a.cloneDeep)(e.positionConfig)}var c=this.context.pluginConfig.config.elements[t].layout;c||(c=this.context.pluginConfig.config.elements[t].layout={}),c.index=n;var u=this.layoutElement.getLayoutController().positionController,h=this.layoutElement.getRoot();"clone"===i&&u.initEl(h)}var d=this.context.rootContext.pluginComponentRef.instance.layoutController.positionController.getSortedElementList(this.layoutElement,0);console.log(d.map(function(t){return t.getLayout().index})),this.elementAdded$.next({previousPath:o,currentPath:"fake"!==i?this.children[t].getPathString():"",addedElementId:t,type:Object(a.isNil)(i)?"move":i})},t.prototype.reindex=function(t){var e=this,n=this.context.rootContext.pluginComponentRef.instance.layoutController.positionController.getSortedElementList(this.layoutElement,0),o=0;n.forEach(function(n){o===t&&(o+=1);var i=e.context.pluginConfig.config.elements[n.getId()].layout;i||(i=e.context.pluginConfig.config.elements[n.getId()].layout={}),i.index=o,o++})},t.prototype.ngAfterViewInit=function(){this.context.rootContext===this.context&&(this.layoutElement=new c(this.context),this.layoutController=new y(this.layoutElement),this.layoutController.init())},t.prototype.addNew=function(){},t.prototype.sortWrappers=function(){for(var t,e=(t=this.children,Object.keys(t).sort(function(e,n){var o=t[e].pluginConfig,i=t[n].pluginConfig;if(o&&i&&void 0!==o.tabIndex&&void 0!==i.tabIndex){if(o.tabIndex<i.tabIndex)return-1;if(o.tabIndex>i.tabIndex)return 1}return 0})),n=0;n<e.length;n++){var o=this.children[e[n]].wrapperComponentRef.hostView,i=this.targetVC.indexOf(o);i!==n&&(this.targetVC.detach(i),this.targetVC.insert(o,n))}},t.prototype.pluginOnUpdate=function(t,e,n,o){var i=this;if(n.diff.config&&Object(r.getDiff)(t.config,e.config).elements){var a=Object(r.deepCompare)(t.config.elements,e.config.elements);Object.keys(a.deleted).forEach(function(t){i.children[t].destroy(),i.layoutElements[t].destroy(),delete i.children[t],delete i.layoutElements[t]}),Object.keys(a.new).forEach(function(t){i.children[t]=i.createPlugin(t,e.config.elements[t])}),Object.keys(a.updated).forEach(function(t){i.children[t].updatePlugin(e.config.elements[t])})}Object.keys(this.children).forEach(function(t){e.config.elements[t]=i.children[t].pluginConfig})},t.prototype.createPluginWrappers=function(){var t=this.context.pluginConfig;t.config&&t.config.elements?this.createPlugins(t.config.elements):console.warn("Group type plugin does not have any child elements",this.context.id)},t.prototype.createPlugins=function(t){for(var e,n=(e=t,Object.keys(e).sort(function(t,n){var o=e[t],i=e[n];if(o&&i&&void 0!==o.tabIndex&&void 0!==i.tabIndex){if(o.tabIndex<i.tabIndex)return-1;if(o.tabIndex>i.tabIndex)return 1}return 0})),o=0;o<n.length;o++){var i=n[o];this.children[i]=this.createPlugin(i,t[i])}},t.prototype.createPlugin=function(t,e,n){var o;void 0===n&&(n=void 0);var i=this.cfr.resolveComponentFactory(this.context.pluginCreator.getPluginWrapperComponent()),r=(o=this.targetVC.createComponent(i,n,this.injector)).instance;return r.currentParentContext=this.context,r.pluginCreator=this.context.pluginCreator,r.pluginLoader=this.context.pluginLoader,r.parentContext=this.context,r.rootContext=this.context.rootContext,r.wrapperComponentRef=o,r.setPlugin(t,e),this.layoutElements[t]=new c(r),"group"===r.pluginConfig.type&&(r.pluginComponentRef.instance.layoutElement=this.layoutElements[t]),r},t.prototype.ngOnDestroy=function(){this.layoutController&&this.layoutController.destroy()},t.\u0275fac=function(e){return new(e||t)(i["\u0275\u0275directiveInject"](i.ComponentFactoryResolver),i["\u0275\u0275directiveInject"](i.Injector),i["\u0275\u0275directiveInject"](s.Overlay),i["\u0275\u0275directiveInject"](s.OverlayContainer),i["\u0275\u0275directiveInject"](i.Renderer2),i["\u0275\u0275directiveInject"](i.ElementRef),i["\u0275\u0275directiveInject"](i.ViewContainerRef),i["\u0275\u0275directiveInject"](i.ChangeDetectorRef),i["\u0275\u0275directiveInject"](r.PLUGIN_CONTEXT))},t.\u0275cmp=i["\u0275\u0275defineComponent"]({type:t,selectors:[["app-group"]],viewQuery:function(t,e){if(1&t&&(i["\u0275\u0275staticViewQuery"](C,!0,i.ViewContainerRef),i["\u0275\u0275staticViewQuery"](x,!0,i.ElementRef)),2&t){var n=void 0;i["\u0275\u0275queryRefresh"](n=i["\u0275\u0275loadQuery"]())&&(e.targetVC=n.first),i["\u0275\u0275queryRefresh"](n=i["\u0275\u0275loadQuery"]())&&(e.wrapperEl=n.first)}},hostVars:2,hostBindings:function(t,e){2&t&&i["\u0275\u0275classProp"]("building",e.isBuilding)},decls:5,vars:2,consts:[["admino-group-wrapper","","cdk-scrollable","",1,"wrapper",3,"ngStyle","cdkTrapFocus"],["wrapperVC","","wrapperRef",""],["targetVC",""]],template:function(t,e){1&t&&(i["\u0275\u0275elementStart"](0,"div",0,1),i["\u0275\u0275template"](3,b,0,0,"ng-template",null,2,i["\u0275\u0275templateRefExtractor"]),i["\u0275\u0275elementEnd"]()),2&t&&i["\u0275\u0275property"]("ngStyle",null==e.context.pluginConfig.config?null:e.context.pluginConfig.config.innerStyle)("cdkTrapFocus",null==e.context.pluginConfig.config?null:e.context.pluginConfig.config.trapFocus)},directives:[s.CdkScrollable,o.NgStyle,s.CdkTrapFocus],styles:['[_nghost-%COMP%]{display:inline-flex}[_nghost-%COMP%], [_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]{overflow:auto;position:relative;scroll-behavior:smooth}[_nghost-%COMP%]  .limit-interaction, [_nghost-%COMP%]  .limit-interaction *{-webkit-user-select:none;-moz-user-select:none;user-select:none;pointer-events:none}[_nghost-%COMP%]  .edit-shadow{box-shadow:5px 5px 10px 10px rgba(0,0,0,.5)}[_nghost-%COMP%]  .adm-drop-zone{outline:4px solid rgba(var(--theme-accent-500),0)!important}[_nghost-%COMP%]  .adm-drop-zone:after{top:0;left:0;content:"";width:100%;height:100%;pointer-events:none;position:absolute;background-color:rgba(var(--theme-accent-500),.05);transition:opacity 1s;opacity:0}[_nghost-%COMP%]  .adm-drop-zone-active{outline:4px solid rgba(var(--theme-accent-500),.3)!important}[_nghost-%COMP%]  .adm-drop-zone-active:after{opacity:1;background-image:repeating-linear-gradient(45deg,transparent,transparent 5px,rgba(var(--theme-primary-500),.1) 0,rgba(var(--theme-primary-500),.1) 10px)}']}),t}(),E=function(t){var e=[];return t?(Object.keys(t).sort(function(e,n){var o=t[e],i=t[n];return o.index>i.index?1:o.index<i.index?-1:0}).forEach(function(n){e.push(t[n])}),e):e},w=n("MdUB");function D(t,e){if(1&t){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"button",6),i["\u0275\u0275listener"]("click",function(t){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275nextContext"]();return e.onButtonEvent({event:t,editButton:e.button})}),i["\u0275\u0275elementStart"](1,"mat-icon"),i["\u0275\u0275text"](2),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&t){var o=i["\u0275\u0275nextContext"](),r=i["\u0275\u0275reference"](5);i["\u0275\u0275property"]("matMenuTriggerFor",r)("matTooltip",o.button.tooltip)("matTooltipDisabled",o.dragActive),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](o.button.icon)}}function k(t,e){if(1&t&&(i["\u0275\u0275elementStart"](0,"mat-icon"),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&t){var n=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate"](n.button.icon)}}function O(t,e){if(1&t&&(i["\u0275\u0275elementStart"](0,"button",7),i["\u0275\u0275template"](1,k,2,1,"mat-icon",8),i["\u0275\u0275text"](2),i["\u0275\u0275elementEnd"]()),2&t){var n=i["\u0275\u0275nextContext"](),o=i["\u0275\u0275reference"](5);i["\u0275\u0275property"]("matMenuTriggerFor",o)("matTooltip",n.button.tooltip)("matTooltipDisabled",n.dragActive),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",n.button.icon),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",n.button.label,"\n")}}function P(t,e){if(1&t){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"button",9),i["\u0275\u0275listener"]("mousedown",function(t){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275nextContext"]();return e.button.supportDrag?e.onButtonEvent({event:t,editButton:e.button}):null})("click",function(t){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275nextContext"]();return e.button.supportDrag?null:e.onButtonEvent({event:t,editButton:e.button})}),i["\u0275\u0275elementStart"](1,"mat-icon"),i["\u0275\u0275text"](2),i["\u0275\u0275elementEnd"](),i["\u0275\u0275elementEnd"]()}if(2&t){var o=i["\u0275\u0275nextContext"]();i["\u0275\u0275property"]("matTooltip",o.button.tooltip)("matTooltipDisabled",o.dragActive),i["\u0275\u0275advance"](2),i["\u0275\u0275textInterpolate"](o.button.icon)}}function W(t,e){if(1&t&&(i["\u0275\u0275elementStart"](0,"mat-icon"),i["\u0275\u0275text"](1),i["\u0275\u0275elementEnd"]()),2&t){var n=i["\u0275\u0275nextContext"](2);i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate"](n.button.icon)}}function M(t,e){if(1&t){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"button",10),i["\u0275\u0275listener"]("mousedown",function(t){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275nextContext"]();return e.button.supportDrag?e.onButtonEvent({event:t,editButton:e.button}):null})("click",function(t){i["\u0275\u0275restoreView"](n);var e=i["\u0275\u0275nextContext"]();return e.button.supportDrag?null:e.onButtonEvent({event:t,editButton:e.button})}),i["\u0275\u0275template"](1,W,2,1,"mat-icon",8),i["\u0275\u0275text"](2),i["\u0275\u0275elementEnd"]()}if(2&t){var o=i["\u0275\u0275nextContext"]();i["\u0275\u0275property"]("matTooltip",o.button.tooltip)("matTooltipDisabled",o.dragActive),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",o.button.icon),i["\u0275\u0275advance"](1),i["\u0275\u0275textInterpolate1"](" ",o.button.label,"\n")}}function I(t,e){if(1&t){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"app-layout-element-button",12),i["\u0275\u0275listener"]("buttonEvent",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"](2).onButtonEvent(t)}),i["\u0275\u0275elementEnd"]()}2&t&&i["\u0275\u0275property"]("button",e.$implicit)}function R(t,e){if(1&t&&i["\u0275\u0275template"](0,I,1,1,"app-layout-element-button",11),2&t){var n=i["\u0275\u0275nextContext"]();i["\u0275\u0275property"]("ngForOf",n.getSubButtons(n.button.subButtons))}}var j=function(){function t(t){this.cd=t,this.buttonEvent=new i.EventEmitter}return t.prototype.ngOnInit=function(){},t.prototype.onButtonEvent=function(t){this.buttonEvent.emit(t)},t.prototype.getSubButtons=function(t){return E(t)},t.\u0275fac=function(e){return new(e||t)(i["\u0275\u0275directiveInject"](i.ChangeDetectorRef))},t.\u0275cmp=i["\u0275\u0275defineComponent"]({type:t,selectors:[["app-layout-element-button"]],viewQuery:function(t,e){var n;1&t&&i["\u0275\u0275viewQuery"](w.MatMenuTrigger,!0),2&t&&i["\u0275\u0275queryRefresh"](n=i["\u0275\u0275loadQuery"]())&&(e.trigger=n.first)},inputs:{dragActive:"dragActive",button:"button"},outputs:{buttonEvent:"buttonEvent"},decls:7,vars:4,consts:[["mat-icon-button","",3,"matMenuTriggerFor","matTooltip","matTooltipDisabled","click",4,"ngIf"],["mat-button","",3,"matMenuTriggerFor","matTooltip","matTooltipDisabled",4,"ngIf"],["mat-icon-button","",3,"matTooltip","matTooltipDisabled","mousedown","click",4,"ngIf"],["mat-button","",3,"matTooltip","matTooltipDisabled","mousedown","click",4,"ngIf"],["menu","matMenu"],["matMenuContent",""],["mat-icon-button","",3,"matMenuTriggerFor","matTooltip","matTooltipDisabled","click"],["mat-button","",3,"matMenuTriggerFor","matTooltip","matTooltipDisabled"],[4,"ngIf"],["mat-icon-button","",3,"matTooltip","matTooltipDisabled","mousedown","click"],["mat-button","",3,"matTooltip","matTooltipDisabled","mousedown","click"],["style","display: block; width: 100%;",3,"button","buttonEvent",4,"ngFor","ngForOf"],[2,"display","block","width","100%",3,"button","buttonEvent"]],template:function(t,e){1&t&&(i["\u0275\u0275template"](0,D,3,4,"button",0),i["\u0275\u0275template"](1,O,3,5,"button",1),i["\u0275\u0275template"](2,P,3,3,"button",2),i["\u0275\u0275template"](3,M,3,4,"button",3),i["\u0275\u0275elementStart"](4,"mat-menu",null,4),i["\u0275\u0275template"](6,R,1,1,"ng-template",5),i["\u0275\u0275elementEnd"]()),2&t&&(i["\u0275\u0275property"]("ngIf",!e.button.label&&e.button.subButtons),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.button.label&&e.button.subButtons),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",!e.button.label&&!e.button.subButtons),i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngIf",e.button.label&&!e.button.subButtons))},directives:[o.NgIf,w.MatMenu,w.MatMenuContent,w.MatButton,w.MatMenuTrigger,w.MatTooltip,w.MatIcon,o.NgForOf,t],styles:["[_nghost-%COMP%]{display:inline-block}[_nghost-%COMP%]  .mat-icon-button{font-size:18px;width:32px;height:32px;line-height:32px}[_nghost-%COMP%]  .mat-icon-button mat-icon{font-size:18px}[_nghost-%COMP%]   .mat-button[_ngcontent-%COMP%]{width:100%;text-align:left}"]}),t}();function T(t,e){if(1&t){var n=i["\u0275\u0275getCurrentView"]();i["\u0275\u0275elementStart"](0,"app-layout-element-button",2),i["\u0275\u0275listener"]("buttonEvent",function(t){return i["\u0275\u0275restoreView"](n),i["\u0275\u0275nextContext"]().onButtonEvent(t)}),i["\u0275\u0275elementEnd"]()}if(2&t){var o=e.$implicit,r=i["\u0275\u0275nextContext"]();i["\u0275\u0275property"]("button",o)("dragActive",r.dragActive)}}var L=function(){function t(t){this.cd=t,this.buttonEvent=new i.EventEmitter}return Object.defineProperty(t.prototype,"editButtons",{get:function(){return this._editButtons},set:function(t){this._editButtons=t,this.processedButtons=E(t)},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){},t.prototype.onButtonEvent=function(t){this.buttonEvent.emit(t)},t.\u0275fac=function(e){return new(e||t)(i["\u0275\u0275directiveInject"](i.ChangeDetectorRef))},t.\u0275cmp=i["\u0275\u0275defineComponent"]({type:t,selectors:[["app-layout-element-button-controls"]],inputs:{dragActive:"dragActive",editButtons:"editButtons"},outputs:{buttonEvent:"buttonEvent"},decls:2,vars:1,consts:[[1,"button-container","mat-elevation-z5"],[3,"button","dragActive","buttonEvent",4,"ngFor","ngForOf"],[3,"button","dragActive","buttonEvent"]],template:function(t,e){1&t&&(i["\u0275\u0275elementStart"](0,"div",0),i["\u0275\u0275template"](1,T,1,2,"app-layout-element-button",1),i["\u0275\u0275elementEnd"]()),2&t&&(i["\u0275\u0275advance"](1),i["\u0275\u0275property"]("ngForOf",e.processedButtons))},directives:[o.NgForOf,j],styles:[".button-container[_ngcontent-%COMP%]{background:rgba(var(--theme-background-400),.95);border-radius:50px;padding:3px;white-space:nowrap}"]}),t}(),B=function(){function t(){}return t.entry=S,t.\u0275mod=i["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=i["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[o.CommonModule,r.SharedModule,s.OverlayModule,w.MatTooltipModule,w.MatButtonModule,w.MatMenuModule,w.MatIconModule,s.A11yModule]]}),t}();i["\u0275\u0275setComponentScope"](m,[o.NgIf,L,o.NgClass,o.NgStyle],[]),e.default=B},Vgaj:function(t,e){t.exports=o},YLtl:function(t,e){t.exports=i},aP7H:function(t,e){t.exports=r},cfyg:function(t,e){t.exports=a},vOrQ:function(t,e){t.exports=s}})});